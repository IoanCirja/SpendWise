<div class="container">
  <!-- Detailed View -->
  <ng-container *ngIf="isDetailedView">
    <mat-card class="details-card">
      <mat-card-header>
        <button mat-icon-button (click)="goBack()">Return</button>
      </mat-card-header>
      <mat-card-content>
        <div class="card-container">
          <mat-card class="plan-card">
            <mat-card-header>
              <mat-card-title>Plan Overview</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div>
                <p><strong>Plan Name:</strong> {{ selectedPlan?.plan_name }}</p>
                <p><strong>Description:</strong> {{ selectedPlan?.description }}</p>
                <!-- Navigation button to HistoryCategoryDetailsComponent -->
                <button mat-raised-button color="primary" (click)="goToDetails()">View History Details</button>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Categories Card -->
          <mat-card class="category-card">
            <mat-card-header>
              <mat-card-title>Categories</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div class="categories">
                <div *ngFor="let category of categoriesWithDetails" class="category-item">
                  <button mat-button (click)="openCategoryDetails(category.name)">
                    {{ category.name }}
                  </button>

                  <app-fluid-indicator [value]="(category.spent / category.price) * 100"></app-fluid-indicator>

                  <div class="category-details">{{ category.spent }}/{{ category.price }}</div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-card-content>
    </mat-card>
  </ng-container>

  <!-- Historical Plans View -->
  <ng-container *ngIf="!isDetailedView">
    <mat-card class="history-card">
      <mat-card-content>
        <div class="plans-list">
          <button mat-raised-button *ngFor="let plan of historyPlans" (click)="onPlanSelect(plan)">
            {{ plan.plan_name }} ({{ plan.date | date:'shortDate' }})
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </ng-container>
</div>